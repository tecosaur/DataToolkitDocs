<!DOCTYPE html><HTML lang="en"><head><script charset="utf-8" src="../../../../assets/default/multidoc_injector.js" type="text/javascript"></script><script charset="utf-8" type="text/javascript">window.MULTIDOCUMENTER_ROOT_PATH = '/DataToolkitDocs/'</script><script charset="utf-8" src="../../../../assets/default/flexsearch.bundle.js" type="text/javascript"></script><script charset="utf-8" src="../../../../assets/default/flexsearch_integration.js" type="text/javascript"></script><meta charset="UTF-8"/><meta content="width=device-width, initial-scale=1.0" name="viewport"/><title>Cache · DataToolkitCommon.jl</title><meta content="Cache · DataToolkitCommon.jl" name="title"/><meta content="Cache · DataToolkitCommon.jl" property="og:title"/><meta content="Cache · DataToolkitCommon.jl" property="twitter:title"/><meta content="Documentation for DataToolkitCommon.jl." name="description"/><meta content="Documentation for DataToolkitCommon.jl." property="og:description"/><meta content="Documentation for DataToolkitCommon.jl." property="twitter:description"/><script data-outdated-warner="" src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script data-main="../../assets/documenter.js" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" data-theme-name="documenter-dark" data-theme-primary-dark="" href="../../assets/themes/documenter-dark.css" rel="stylesheet" type="text/css"/><link class="docs-theme-link" data-theme-name="documenter-light" data-theme-primary="" href="../../assets/themes/documenter-light.css" rel="stylesheet" type="text/css"/><script src="../../assets/themeswap.js"></script><link href="nothing/DataToolkitDocs/common/stable/plugins/cache/" rel="canonical"/><link href="../../../../assets/default/multidoc.css" rel="stylesheet" type="text/css"/><link href="../../../../assets/default/flexsearch.css" rel="stylesheet" type="text/css"/></head><body><nav id="multi-page-nav"><a class="brand" href="../../../../../../DataToolkitDocs"><img alt="home" src="../../../../logo-small.svg"/></a><div class="hidden-on-mobile" id="nav-items"><a class="nav-link nav-item" href="../../../../ref/">DataToolkit</a><a class="nav-link nav-item" href="../../../../base/">Base</a><a class="nav-link active nav-item" href="../../../">Common</a><div class="nav-dropdown"><button class="nav-item dropdown-label">Collections</button><ul class="nav-dropdown-container"></ul></div><div class="search nav-item"><input id="search-input" placeholder="Search..."/><ul class="suggestions hidden" id="search-result-container"></ul><div class="search-keybinding">/</div></div></div><button id="multidoc-toggler"><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"></path></svg></button></nav><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img alt="DataToolkitCommon.jl logo" src="../../assets/logo.svg"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">DataToolkitCommon.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Introduction</a></li><li><span class="tocitem">Storage</span><ul><li><a class="tocitem" href="../../storage/filesystem/">Filesystem</a></li><li><a class="tocitem" href="../../storage/git/">Git</a></li><li><a class="tocitem" href="../../storage/null/">Null</a></li><li><a class="tocitem" href="../../storage/passthrough/">Passthrough</a></li><li><a class="tocitem" href="../../storage/raw/">Raw</a></li><li><a class="tocitem" href="../../storage/web/">Web</a></li></ul></li><li><span class="tocitem">Loaders/Writers</span><ul><li><a class="tocitem" href="../../saveload/chain/">Chain</a></li><li><a class="tocitem" href="../../saveload/compression/">Compression</a></li><li><a class="tocitem" href="../../saveload/csv/">CSV</a></li><li><a class="tocitem" href="../../saveload/delim/">Delim</a></li><li><a class="tocitem" href="../../saveload/iotofile/">IO to File</a></li><li><a class="tocitem" href="../../saveload/jpeg/">JPEG</a></li><li><a class="tocitem" href="../../saveload/json/">JSON</a></li><li><a class="tocitem" href="../../saveload/julia/">Julia</a></li><li><a class="tocitem" href="../../saveload/netpbm/">Netpbm</a></li><li><a class="tocitem" href="../../saveload/passthrough/">Passthrough</a></li><li><a class="tocitem" href="../../saveload/png/">PNG</a></li><li><a class="tocitem" href="../../saveload/qoi/">QOI</a></li><li><a class="tocitem" href="../../saveload/sqlite/">SQLite</a></li><li><a class="tocitem" href="../../saveload/tar/">Tar</a></li><li><a class="tocitem" href="../../saveload/tiff/">TIFF</a></li><li><a class="tocitem" href="../../saveload/xlsx/">XLSX</a></li><li><a class="tocitem" href="../../saveload/zip/">Zip</a></li></ul></li><li><span class="tocitem">Plugins</span><ul><li class="is-active"><a class="tocitem" href="">Cache</a></li><li><a class="tocitem" href="../defaults/">Defaults</a></li><li><a class="tocitem" href="../log/">Log</a></li><li><a class="tocitem" href="../memorise/">Memorise</a></li><li><a class="tocitem" href="../store/">Store</a></li><li><a class="tocitem" href="../versions/">Versions</a></li></ul></li><li><a class="tocitem" href="../../repl/">REPL</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" href="#" id="documenter-sidebar-button"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Plugins</a></li><li class="is-active"><a href="">Cache</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="">Cache</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/tecosaur/DataToolkitCommon.jl/blob/main/docs/src/plugins/cache.md#L" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" href="#" id="documenter-settings-button" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" href="javascript:;" id="documenter-article-toggle-button" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Cache"><a class="docs-heading-anchor" href="#Cache">Cache</a><a id="Cache-1"></a><a class="docs-heading-anchor-permalink" href="#Cache" title="Permalink"></a></h1><p>Cache the results of data loaders using the <code>Serialisation</code> standard library. Cache keys are determined by the loader "recipe" and the type requested.</p><p>It is important to note that not all data types can be cached effectively, such as an <code>IOStream</code>.</p><h2>Recipe hashing</h2><p>The driver, parameters, type(s), of a loader and the storage drivers of a dataset are all combined into the "recipe hash" of a loader.</p><pre><code class="nohighlight hljs">╭─────────╮             ╭──────╮
│ Storage │             │ Type │
╰───┬─────╯             ╰───┬──╯
    │    ╭╌╌╌╌╌╌╌╌╌╮    ╭───┴────╮ ╭────────╮
    ├╌╌╌╌┤ DataSet ├╌╌╌╌┤ Loader ├─┤ Driver │
    │    ╰╌╌╌╌╌╌╌╌╌╯    ╰───┬────╯ ╰────────╯
╭───┴─────╮             ╭───┴───────╮
│ Storage ├─╼           │ Parmeters ├─╼
╰─────┬───╯             ╰───────┬───╯
      ╽                         ╽</code></pre><p>Since the parameters of the loader (and each storage backend) can reference other data sets (indicated with <code>╼</code> and <code>╽</code>), this hash is computed recursively, forming a Merkle Tree. In this manner the entire "recipe" leading to the final result is hashed.</p><pre><code class="nohighlight hljs">                ╭───╮
                │ E │
        ╭───╮   ╰─┬─╯
        │ B ├──▶──┤
╭───╮   ╰─┬─╯   ╭─┴─╮
│ A ├──▶──┤     │ D │
╰───╯   ╭─┴─╮   ╰───╯
        │ C ├──▶──┐
        ╰───╯   ╭─┴─╮
                │ D │
                ╰───╯</code></pre><p>In this example, the hash for a loader of data set "A" relies on the data sets "B" and "C", and so their hashes are calculated and included. "D" is required by both "B" and "C", and so is included in each. "E" is also used in "D".</p><h2>Configuration</h2><h4>Store path</h4><p>This uses the same <code>store.path</code> configuration variable as the <code>store</code> plugin (which see).</p><h4>Disabling on a per-loader basis</h4><p>Caching of individual loaders can be disabled by setting the "cache" parameter to <code>false</code>, i.e.</p><pre><code class="language-toml hljs">[[somedata.loader]]
cache = false
...</code></pre><h4>Store management</h4><p>System-wide configuration can be set via the <code>store config set</code> REPL command, or directly modifying the <code>DataToolkitCommon.Store.getinventory().config</code> struct.</p><p>A few (system-wide) settings determine garbage collection behaviour:</p><ul><li><code>auto_gc</code> (default 2): How often to automatically run garbage collection (in hours). Set to a non-positive value to disable.</li><li><code>max_age</code> (default 30): The maximum number of days since a collection was last seen before it is removed from consideration.</li><li><code>max_size</code> (default 53687091200): The maximum (total) size of the store.</li><li><code>recency_beta</code> (default 1): When removing items to avoid going over <code>max_size</code>, how much recency should be valued. Can be set to any value in (-∞, ∞). Larger (positive) values weight recency more, and negative values weight size more. -1 and 1 are equivalent.</li><li><code>store_dir</code> (default store): The directory (either as an absolute path, or relative to the inventory file) that should be used for storage (IO) cache files.</li><li><code>cache_dir</code> (default cache): The directory (either as an absolute path, or relative to the inventory file) that should be used for Julia cache files.</li></ul></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../saveload/zip/">« Zip</a><a class="docs-footer-nextpage" href="../defaults/">Defaults »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label></p><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div><p></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.1.0 on <span class="colophon-date" title="Sunday 8 October 2023 16:58">Sunday 8 October 2023</span>. Using Julia version 1.9.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></HTML>